[
  {
    "objectID": "hsa_datasets.html",
    "href": "hsa_datasets.html",
    "title": "Human datasets",
    "section": "",
    "text": "First, setup the pin-board from which well retrieve the human datasets\n\nlibrary(haemdata)\nlibrary(SummarizedExperiment)\nuse_pinboard(\"onedrive\")\n\n\n\nCOH FLT3 patients\nRelapse patients\nMDS patients\nnon-AML patients\nCombined\n\n\n\nCity of Hope Biobank FLT3 patients\n\n\n\n\n\n\nPatient metadata\n\n\n\nLimited patient metadata are availalbe for these samples:\nsample_id, patient_id, sex, diagnosis_year, clinical_treatment, date_of_diagnosis, age_at_diagnosis, sample_date\n\n\n\nflt3 &lt;- get_pin(\"hsa_mrna_flt3_GENCODEr40_qc.rds\")\n\npca &lt;- pca_se(flt3, col_by = \"patient_id\")\n\n\npca$biplot\n\n\n\npca$pairs_plot\n\n\n\n\n\npca$correlation_plot\n\n\n\n\n\n\nKim et al 2020 Sci Rep \nBioproject: PRJEB27973\n\n\n\n\n\n\nPan-Cancer Panel\n\n\n\nThis dataset is TruSight RNA Pan-Cancer Panel (1385 genes) (Illumina, Inc., San Diego, CA USA). This is not a full transcriptome dataset.\n\n\n\n\n\n\n\n\nPatient metadata\n\n\n\nNo further patient-level metadata was made available either via NCBI or the publication, although the supplementary tables contain extensive summary statistics. Contact the authors for more information.\n\n\n\nkim &lt;- get_pin(\"hsa_mrna_kim_GENCODEr40_qc.rds\")\n\npca &lt;- pca_se(kim, col_by = \"timepoint\")\n\n\npca$biplot\n\n\n\npca$pairs_plot\n\n\n\n\n\npca$correlation_plot\n\n\n\n\n\n\n\n\nDataset\nID\nTechnology\nSamples\n\n\nEGAD00001003891\nIllumina\nHiSeq 2500\n266\n\n\n\nTranscriptome sequencing was performed on 214 patients with myelodysplasia in this study. RNA was obtained from bone marrow CD34+ cells (n=100) and/or bone marrow mononuclear cells (n=165). Transcriptome sequencing was performed for both cell fractions in 51 patients. A total of 211 patients were genotyped by targeted deep sequencing. For controls, bone marrow CD34+ cells and bone marrow mononuclear cells were obtained from three healthy adults each.\n\n\n\n\n\n\nPatient metadata\n\n\n\nNo further patient-level metadata was made available either via EGA or the publication, although the supplementary tables contain extensive summary statistics. Contact the authors for more information.\n\n\n\n\n\n\n\n\nUsage\n\n\n\nData were downloaded from EGA with approval and must not be used for any purpose other than PSON studies.\n\n\nShiozawa et al 2017 Blood \nShiozawa et al 2018 Nat Comm \n\nmds &lt;- get_pin(\"hsa_mrna_mds_GENCODEr40_qc.rds\")\n\npca &lt;- pca_se(mds, col_by = \"tissue\")\n\n\npca$biplot\n\n\n\npca$pairs_plot\n\n\n\n\n\npca$correlation_plot\n\n\n\n\n\n\n\nNon-AML patients sourced form a variety of studies:\n- [PRJNA252189](https://www.ncbi.nlm.nih.gov/bioproject/?term=PRJNA252189)  Transcriptomic profiling of peripheral blood mononuclear cells from healthy individuals                                                                                    \n- [PRJNA261023](https://www.ncbi.nlm.nih.gov/bioproject/?term=PRJNA261023)  Transcriptomic profiling of bone marrow cells from healthy individuals                                                                                                     \n- [PRJNA268220](https://www.ncbi.nlm.nih.gov/bioproject/?term=PRJNA268220)  RNA sequencing of bone marrow CD34+ cells from myelodysplastic syndrome patients with and without SF3B1 mutation and from healthy controls                                 \n- [PRJNA294808](https://www.ncbi.nlm.nih.gov/bioproject/?term=PRJNA294808)  Transcriptomes of peripheral blood mononuclear cells from a Guillain-Barre Syndrome patient and her healthy twin sampled at three different points of the disease evolution\n- [PRJNA453199](https://www.ncbi.nlm.nih.gov/bioproject/?term=PRJNA453199)  RNA sequencing analysis of adult mixed phenotype acute leukemia (MPAL)                                                                                                     \n- [PRJNA487456](https://www.ncbi.nlm.nih.gov/bioproject/?term=PRJNA487456)  RNA-Seq of CD34+ Bone Marrow Progenitors from Healthy Donors                                                                                                               \n- [PRJNA493081](https://www.ncbi.nlm.nih.gov/bioproject/?term=PRJNA493081)  Human Bone Marrow Assessment by Single Cell RNA Sequencing, Mass Cytometry and Flow Cytometry [bulk]         \n\nnon_aml &lt;- get_pin(\"hsa_mrna_non_aml_GENCODEr40_qc.rds\")\n\npca &lt;- pca_se(non_aml, col_by = \"study_accession\")\n\n\npca$biplot\n\n\n\npca$pairs_plot\n\n\n\n\n\npca$correlation_plot\n\n\n\n\n\n\n\nShow the codemat_flt3 &lt;- assay(flt3, \"abundance\")\nmat_kim &lt;- assay(kim, \"abundance\")\nmat_mds &lt;- assay(mds, \"abundance\")\nmat_non_aml &lt;- assay(non_aml, \"abundance\")\n\nmat&lt;-cbind(mat_flt3,\n    mat_kim,\n    mat_mds,\n    mat_non_aml) \n\nrow_data &lt;- rowData(flt3)\n\ncol_flt3 &lt;- colData(flt3)|&gt;as.data.frame()\ncol_kim &lt;- colData(kim)|&gt;as.data.frame()\ncol_mds &lt;- colData(mds)|&gt;as.data.frame()\ncol_non_aml &lt;- colData(non_aml)|&gt;as.data.frame()\n\ncol_data &lt;- dplyr::bind_rows(\n    col_flt3,\n    col_kim,\n    col_mds,\n    col_non_aml) |&gt; DataFrame()\n\nse &lt;- SummarizedExperiment(assays = list(\"abundance\"=mat), colData=col_data, rowData=row_data)\n\npca &lt;- pca_se(se, col_by = \"cohort\")\n\n\n\npca$biplot\n\n\n\npca$pairs_plot\n\n\n\n\n\npca$correlation_plot"
  },
  {
    "objectID": "hsa_datasets.html#human-datasets",
    "href": "hsa_datasets.html#human-datasets",
    "title": "Human datasets",
    "section": "",
    "text": "First, setup the pin-board from which well retrieve the human datasets\n\nlibrary(haemdata)\nlibrary(SummarizedExperiment)\nuse_pinboard(\"onedrive\")\n\n\n\nCOH FLT3 patients\nRelapse patients\nMDS patients\nnon-AML patients\nCombined\n\n\n\nCity of Hope Biobank FLT3 patients\n\n\n\n\n\n\nPatient metadata\n\n\n\nLimited patient metadata are availalbe for these samples:\nsample_id, patient_id, sex, diagnosis_year, clinical_treatment, date_of_diagnosis, age_at_diagnosis, sample_date\n\n\n\nflt3 &lt;- get_pin(\"hsa_mrna_flt3_GENCODEr40_qc.rds\")\n\npca &lt;- pca_se(flt3, col_by = \"patient_id\")\n\n\npca$biplot\n\n\n\npca$pairs_plot\n\n\n\n\n\npca$correlation_plot\n\n\n\n\n\n\nKim et al 2020 Sci Rep \nBioproject: PRJEB27973\n\n\n\n\n\n\nPan-Cancer Panel\n\n\n\nThis dataset is TruSight RNA Pan-Cancer Panel (1385 genes) (Illumina, Inc., San Diego, CA USA). This is not a full transcriptome dataset.\n\n\n\n\n\n\n\n\nPatient metadata\n\n\n\nNo further patient-level metadata was made available either via NCBI or the publication, although the supplementary tables contain extensive summary statistics. Contact the authors for more information.\n\n\n\nkim &lt;- get_pin(\"hsa_mrna_kim_GENCODEr40_qc.rds\")\n\npca &lt;- pca_se(kim, col_by = \"timepoint\")\n\n\npca$biplot\n\n\n\npca$pairs_plot\n\n\n\n\n\npca$correlation_plot\n\n\n\n\n\n\n\n\nDataset\nID\nTechnology\nSamples\n\n\nEGAD00001003891\nIllumina\nHiSeq 2500\n266\n\n\n\nTranscriptome sequencing was performed on 214 patients with myelodysplasia in this study. RNA was obtained from bone marrow CD34+ cells (n=100) and/or bone marrow mononuclear cells (n=165). Transcriptome sequencing was performed for both cell fractions in 51 patients. A total of 211 patients were genotyped by targeted deep sequencing. For controls, bone marrow CD34+ cells and bone marrow mononuclear cells were obtained from three healthy adults each.\n\n\n\n\n\n\nPatient metadata\n\n\n\nNo further patient-level metadata was made available either via EGA or the publication, although the supplementary tables contain extensive summary statistics. Contact the authors for more information.\n\n\n\n\n\n\n\n\nUsage\n\n\n\nData were downloaded from EGA with approval and must not be used for any purpose other than PSON studies.\n\n\nShiozawa et al 2017 Blood \nShiozawa et al 2018 Nat Comm \n\nmds &lt;- get_pin(\"hsa_mrna_mds_GENCODEr40_qc.rds\")\n\npca &lt;- pca_se(mds, col_by = \"tissue\")\n\n\npca$biplot\n\n\n\npca$pairs_plot\n\n\n\n\n\npca$correlation_plot\n\n\n\n\n\n\n\nNon-AML patients sourced form a variety of studies:\n- [PRJNA252189](https://www.ncbi.nlm.nih.gov/bioproject/?term=PRJNA252189)  Transcriptomic profiling of peripheral blood mononuclear cells from healthy individuals                                                                                    \n- [PRJNA261023](https://www.ncbi.nlm.nih.gov/bioproject/?term=PRJNA261023)  Transcriptomic profiling of bone marrow cells from healthy individuals                                                                                                     \n- [PRJNA268220](https://www.ncbi.nlm.nih.gov/bioproject/?term=PRJNA268220)  RNA sequencing of bone marrow CD34+ cells from myelodysplastic syndrome patients with and without SF3B1 mutation and from healthy controls                                 \n- [PRJNA294808](https://www.ncbi.nlm.nih.gov/bioproject/?term=PRJNA294808)  Transcriptomes of peripheral blood mononuclear cells from a Guillain-Barre Syndrome patient and her healthy twin sampled at three different points of the disease evolution\n- [PRJNA453199](https://www.ncbi.nlm.nih.gov/bioproject/?term=PRJNA453199)  RNA sequencing analysis of adult mixed phenotype acute leukemia (MPAL)                                                                                                     \n- [PRJNA487456](https://www.ncbi.nlm.nih.gov/bioproject/?term=PRJNA487456)  RNA-Seq of CD34+ Bone Marrow Progenitors from Healthy Donors                                                                                                               \n- [PRJNA493081](https://www.ncbi.nlm.nih.gov/bioproject/?term=PRJNA493081)  Human Bone Marrow Assessment by Single Cell RNA Sequencing, Mass Cytometry and Flow Cytometry [bulk]         \n\nnon_aml &lt;- get_pin(\"hsa_mrna_non_aml_GENCODEr40_qc.rds\")\n\npca &lt;- pca_se(non_aml, col_by = \"study_accession\")\n\n\npca$biplot\n\n\n\npca$pairs_plot\n\n\n\n\n\npca$correlation_plot\n\n\n\n\n\n\n\nShow the codemat_flt3 &lt;- assay(flt3, \"abundance\")\nmat_kim &lt;- assay(kim, \"abundance\")\nmat_mds &lt;- assay(mds, \"abundance\")\nmat_non_aml &lt;- assay(non_aml, \"abundance\")\n\nmat&lt;-cbind(mat_flt3,\n    mat_kim,\n    mat_mds,\n    mat_non_aml) \n\nrow_data &lt;- rowData(flt3)\n\ncol_flt3 &lt;- colData(flt3)|&gt;as.data.frame()\ncol_kim &lt;- colData(kim)|&gt;as.data.frame()\ncol_mds &lt;- colData(mds)|&gt;as.data.frame()\ncol_non_aml &lt;- colData(non_aml)|&gt;as.data.frame()\n\ncol_data &lt;- dplyr::bind_rows(\n    col_flt3,\n    col_kim,\n    col_mds,\n    col_non_aml) |&gt; DataFrame()\n\nse &lt;- SummarizedExperiment(assays = list(\"abundance\"=mat), colData=col_data, rowData=row_data)\n\npca &lt;- pca_se(se, col_by = \"cohort\")\n\n\n\npca$biplot\n\n\n\npca$pairs_plot\n\n\n\n\n\npca$correlation_plot"
  },
  {
    "objectID": "cml_datasets.html",
    "href": "cml_datasets.html",
    "title": "CML datasets",
    "section": "",
    "text": "CML treatment mice\nCML miR142 KO\n\n\n\n\n\nBiplot\nPairs plot\nCorrelation table\nHuman transgenes\nSurvival\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nBiplot\nPairs plot\nCorrelation table\nPlotly PCA"
  },
  {
    "objectID": "aml_datasets.html",
    "href": "aml_datasets.html",
    "title": "AML datasets",
    "section": "",
    "text": "Note: Validation mice also available via Haemdata/Ondrive. See X for more details.\nFirst, we need to setup the pin-board and download the mouse datasets.\n\nlibrary(haemdata)\nuse_pinboard(\"onedrive\")\n\nall_mice &lt;- get_pin(\"mmu_mrna_all_mice_GENCODEm28_HLT_qc.rds\")\nmetadata_mmu &lt;- get_pin(\"metadata_mmu.csv\")\n\n\n\n2016 mice\n2018 mice\nRadiation mice\nChemo mice\nscRNAseq mice 2022\nBone marrow\n\n\n\n\nse &lt;- subset(all_mice,\n    select = grepl(\"2016\", SummarizedExperiment::colData(all_mice)$batch)\n)\n\npca &lt;- pca_se(se)\n\n\npca$biplot\n\n\n\npca$pairs_plot\n\n\n\n\n\npca$correlation_plot\n\n\n\n\n\nplot_transgenes_se(se)\n\n\n\n\n\nmetadata_mmu |&gt;\nplot_cohort_survival(\"AML.mRNA.2016\")\n\n\n\n\n\n\n\nse &lt;- subset(all_mice,\n    select = grepl(\"AML.mRNA.2018.all_samples\", SummarizedExperiment::colData(all_mice)$cohort)\n)\n\npca &lt;- pca_se(se)\n\n\npca$biplot\n\n\n\npca$pairs_plot\n\n\n\n\n\npca$correlation_plot\n\n\n\n\n\nplot_transgenes_se(se)\n\n\nmetadata_mmu |&gt;\nplot_cohort_survival(\"AML.mRNA.2018\")\n\n\n\n\n\n\n\nse &lt;- subset(all_mice,\n    select = grepl(\"AML.mRNA.2020\", SummarizedExperiment::colData(all_mice)$cohort)\n)\nse &lt;- subset(se,\n    select = grepl(\"PBMC\", SummarizedExperiment::colData(se)$tissue)\n)\n\npca &lt;- pca_se(se)\n\n\npca$biplot\n\n\n\npca$pairs_plot\n\n\n\n\n\npca$correlation_plot\n\n\n\n\n\nplot_transgenes_se(se)\n\n\n\n\n\nmetadata_mmu |&gt;\nplot_cohort_survival(\"AML.mRNA.2020\")\n\n\n\n\n\n\n\nse &lt;- subset(all_mice,\n    select = grepl(\"RxGroup\", SummarizedExperiment::colData(all_mice)$cohort)\n)\n\npca &lt;- pca_se(se)\n\n\npca$biplot\n\n\n\npca$pairs_plot\n\n\n\n\n\npca$correlation_plot\n\n\n\n\n\nplot_transgenes_se(se)\n\n\nmetadata_mmu |&gt;\nplot_cohort_survival(\"RxGroup\")\n\n\n\n\n\n\n\nse &lt;- subset(all_mice,\n    select = grepl(\"AML.scRNAseq.2022\", SummarizedExperiment::colData(all_mice)$cohort)\n)\n\npca &lt;- pca_se(se)\n\n\npca$biplot\n\n\n\npca$pairs_plot\n\n\n\n\n\npca$correlation_plot\n\n\n\n\n\nplot_transgenes_se(se)\n\n\n\n\nse &lt;- subset(all_mice,\n    select = (\"BM\" == SummarizedExperiment::colData(all_mice)$tissue)\n)\nse &lt;- subset(se,\n    select = grepl(\"AML\", SummarizedExperiment::colData(se)$cohort)\n)\n\npca &lt;- pca_se(se)\n\n\npca$biplot\n\n\n\npca$pairs_plot\n\n\n\n\n\npca$correlation_plot\n\n\n\n\n\nplot_transgenes_se(se)\n\n\n\n\n:::"
  },
  {
    "objectID": "aml_datasets.html#mouse-datasets",
    "href": "aml_datasets.html#mouse-datasets",
    "title": "AML datasets",
    "section": "",
    "text": "Note: Validation mice also available via Haemdata/Ondrive. See X for more details.\nFirst, we need to setup the pin-board and download the mouse datasets.\n\nlibrary(haemdata)\nuse_pinboard(\"onedrive\")\n\nall_mice &lt;- get_pin(\"mmu_mrna_all_mice_GENCODEm28_HLT_qc.rds\")\nmetadata_mmu &lt;- get_pin(\"metadata_mmu.csv\")\n\n\n\n2016 mice\n2018 mice\nRadiation mice\nChemo mice\nscRNAseq mice 2022\nBone marrow\n\n\n\n\nse &lt;- subset(all_mice,\n    select = grepl(\"2016\", SummarizedExperiment::colData(all_mice)$batch)\n)\n\npca &lt;- pca_se(se)\n\n\npca$biplot\n\n\n\npca$pairs_plot\n\n\n\n\n\npca$correlation_plot\n\n\n\n\n\nplot_transgenes_se(se)\n\n\n\n\n\nmetadata_mmu |&gt;\nplot_cohort_survival(\"AML.mRNA.2016\")\n\n\n\n\n\n\n\nse &lt;- subset(all_mice,\n    select = grepl(\"AML.mRNA.2018.all_samples\", SummarizedExperiment::colData(all_mice)$cohort)\n)\n\npca &lt;- pca_se(se)\n\n\npca$biplot\n\n\n\npca$pairs_plot\n\n\n\n\n\npca$correlation_plot\n\n\n\n\n\nplot_transgenes_se(se)\n\n\nmetadata_mmu |&gt;\nplot_cohort_survival(\"AML.mRNA.2018\")\n\n\n\n\n\n\n\nse &lt;- subset(all_mice,\n    select = grepl(\"AML.mRNA.2020\", SummarizedExperiment::colData(all_mice)$cohort)\n)\nse &lt;- subset(se,\n    select = grepl(\"PBMC\", SummarizedExperiment::colData(se)$tissue)\n)\n\npca &lt;- pca_se(se)\n\n\npca$biplot\n\n\n\npca$pairs_plot\n\n\n\n\n\npca$correlation_plot\n\n\n\n\n\nplot_transgenes_se(se)\n\n\n\n\n\nmetadata_mmu |&gt;\nplot_cohort_survival(\"AML.mRNA.2020\")\n\n\n\n\n\n\n\nse &lt;- subset(all_mice,\n    select = grepl(\"RxGroup\", SummarizedExperiment::colData(all_mice)$cohort)\n)\n\npca &lt;- pca_se(se)\n\n\npca$biplot\n\n\n\npca$pairs_plot\n\n\n\n\n\npca$correlation_plot\n\n\n\n\n\nplot_transgenes_se(se)\n\n\nmetadata_mmu |&gt;\nplot_cohort_survival(\"RxGroup\")\n\n\n\n\n\n\n\nse &lt;- subset(all_mice,\n    select = grepl(\"AML.scRNAseq.2022\", SummarizedExperiment::colData(all_mice)$cohort)\n)\n\npca &lt;- pca_se(se)\n\n\npca$biplot\n\n\n\npca$pairs_plot\n\n\n\n\n\npca$correlation_plot\n\n\n\n\n\nplot_transgenes_se(se)\n\n\n\n\nse &lt;- subset(all_mice,\n    select = (\"BM\" == SummarizedExperiment::colData(all_mice)$tissue)\n)\nse &lt;- subset(se,\n    select = grepl(\"AML\", SummarizedExperiment::colData(se)$cohort)\n)\n\npca &lt;- pca_se(se)\n\n\npca$biplot\n\n\n\npca$pairs_plot\n\n\n\n\n\npca$correlation_plot\n\n\n\n\n\nplot_transgenes_se(se)\n\n\n\n\n:::"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "Welcome to Haemdata Notes, a platform for publishing analytical notebooks making use of Haemdata.\nIn addition to cohort reports, it would be great if we can collect complete analyses or short examples and snippets of code in notebooks - Jupyter, Quarto, Rmarkdown, or a multitude of other formats.\nThe website is built with Quarto, a powerful scientific publishing platform that supports Python, R, Julia, and Observable JavaScript, and many other languages via Jupyter notebooks, for example."
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Haemdata notebooks",
    "section": "",
    "text": "This is a Quarto website.\nTo learn more about Quarto websites visit https://quarto.org/docs/websites."
  },
  {
    "objectID": "scRNAseq.html",
    "href": "scRNAseq.html",
    "title": "scRNAseq",
    "section": "",
    "text": "library(haemdata)\nlibrary(Seurat)\nlibrary(patchwork)\nlibrary(ggplot2)\nlibrary(scCustomize)\nlibrary(dplyr)\n\n\nShow/hide helper functions code\n\n#' Make a simplified UMAP plot\n#'\n#' See https://twitter.com/samuel_marsh/status/1526550833479008257\n#' Code https://twitter.com/timoast/status/1526237116035891200/photo/1\n#'\n#' @param x a ggpplot object from Seurat::DimPlot\n#' @return a DimPlot with a simplified UMAP theme\n#' @rdname dim_plot_mod\ndim_plot_mod &lt;- function(x) {\n    p1 &lt;- x + theme_void()\n    p2 &lt;- ggplot(data.frame(x = 100, y = 100), aes(x = x, y = y)) +\n        geom_point() +\n        xlim(c(0, 10)) +\n        ylim(c(0, 10)) +\n        theme_classic() +\n        ylab(\"UMAP2\") +\n        xlab(\"UMAP1\") +\n        theme(\n            axis.text.y = element_blank(),\n            axis.text.x = element_blank(),\n            axis.ticks = element_blank(),\n            axis.line = element_line(\n                arrow = arrow(length = unit(0.5, \"cm\"), type = \"closed\")\n            )\n        )\n    layout &lt;- c(\n        patchwork::area(t = 1, l = 2, b = 11, r = 11),\n        patchwork::area(t = 10, l = 1, b = 12, r = 2)\n    )\n\n    p1 + p2 + patchwork::plot_layout(design = layout)\n}\n\n#' Make a QC patchwork plot of per-sample scRNAseq data\n#' - Genes per cell\n#' - UMIs per cell\n#' - log(UMIs per cell)\n#' - % mtDNA per cell\n#'\n#' See https://samuel-marsh.github.io/scCustomize/articles/QC_Plots.html\n#'\n#' @param seurat_object a Seurat object\n#' @return a patchwork plot of the QC data\n#' @rdname dim_plot_mod\nsc_qc_plot_per_sample &lt;- function(seurat_object) {\n\n    pal &lt;- scCustomize::DiscretePalette_scCustomize(num_colors = 60, palette = \"varibow\")\n    Seurat::Idents(seurat_object) &lt;- \"orig.ident\"\n    n1 &lt;- scCustomize::QC_Plot_UMIvsGene(\n        seurat_object,\n        low_cutoff_gene = 800,\n        high_cutoff_gene = 5500,\n        low_cutoff_UMI = 500,\n        high_cutoff_UMI = 50000,\n        colors_use = pal,\n        x_axis_label = \"UMIs per Cell\",\n        y_axis_label = \"Genes per Cell\"\n    ) +\n        theme(legend.position = \"none\", axis.text.x = element_text(angle = 45, hjust = 1)) +\n        labs(title = \"Cells by Sample ID\")\n    n2 &lt;- scCustomize::QC_Plot_UMIvsGene(\n        seurat_object,\n        meta_gradient_name = \"percent_mt\",\n        low_cutoff_gene = 800,\n        high_cutoff_gene = 5500,\n        high_cutoff_UMI = 45000,\n        x_axis_label = \"UMIs per Cell\",\n        y_axis_label = \"Genes per Cell\"\n    ) +\n        theme(axis.text.x = element_text(angle = 45, hjust = 1)) +\n        labs(title = \"Cells by % mtDNA\")\n\n    upper &lt;- patchwork::wrap_plots(n1, n2, nrow = 1)\n\n    p1 &lt;- scCustomize::QC_Plots_Genes(seurat_object, low_cutoff = 800, high_cutoff = 5500, pt.size = 0, plot_title = \"Genes per cell\", raster = TRUE, colors_use = pal)\n    p2 &lt;- scCustomize::QC_Plots_Feature(seurat_object, feature = \"percent_ribo\", low_cutoff = 5, pt.size = 0, plot_title = \"% rRNA per cell\", raster = TRUE, colors_use = pal)\n    p3 &lt;- scCustomize::QC_Plots_UMIs(seurat_object, low_cutoff = 1200, high_cutoff = 45000, pt.size = 0, y_axis_log = TRUE, plot_title = \"log(UMIs per cell)\", raster = TRUE, colors_use = pal)\n    p4 &lt;- scCustomize::QC_Plots_Feature(seurat_object, feature = \"percent_mt\", high_cutoff = 20, pt.size = 0, plot_title = \"% mtDNA per cell\", raster = TRUE, colors_use = pal)\n\n    lower &lt;- patchwork::wrap_plots(p1, p2, p3, p4, nrow = 2) &\n        ggplot2::theme(plot.title = element_text(size = 10), legend.position = \"none\", axis.text = element_text(size = 8))\n\n    patchwork::wrap_plots(upper, lower, nrow = 2)\n}\n\n#' Make a QC plot of per-sample median per-cell values\n#' Median values per sample:\n#' - Genes per cell\n#' - UMIs per cell\n#' - percent mt per cell\n#'\n#' See https://samuel-marsh.github.io/scCustomize/articles/QC_Plots.html\n#'\n#' @param seurat_object a Seurat object\n#' @param group_by a meta.data column with fewer than 8 unique values to group by\n#' @return a patchwork plot of the QC data\n#' @rdname dim_plot_mod\nsc_qc_plot_group_by &lt;- function(seurat_object, group_by) {\n    pal &lt;- scCustomize::DiscretePalette_scCustomize(num_colors = 40, palette = \"ditto_seq\")\n\n    d1 &lt;- Seurat::DimPlot(seurat_object, reduction = \"umap\", group.by = {{ group_by }}, cols = pal) |&gt;\n        dim_plot_mod()\n    my_theme &lt;- ggplot2::theme(plot.title = element_blank(), legend.position = \"none\", axis.text.y = element_text(size = 9))\n    p1 &lt;- scCustomize::Plot_Median_Genes(seurat_object, group_by = {{ group_by }}, colors_use = pal) + my_theme\n    p2 &lt;- scCustomize::Plot_Median_UMIs(seurat_object, group_by = {{ group_by }}, colors_use = pal) + my_theme\n    p3 &lt;- scCustomize::Plot_Median_Other(seurat_object, median_var = \"percent_mt\", group_by = {{ group_by }}, colors_use = pal) + my_theme\n    p4 &lt;- scCustomize::Plot_Median_Other(seurat_object, median_var = \"percent_ribo\", group_by = {{ group_by }}, colors_use = pal) + my_theme\n    p5 &lt;- scCustomize::Plot_Median_Other(seurat_object, median_var = \"percent_myh11\", group_by = {{ group_by }}, colors_use = pal) + my_theme\n    p6 &lt;- scCustomize::Plot_Cells_per_Sample(seurat_object, group_by = {{ group_by }}, colors_use = pal) + my_theme\n\n    layout &lt;- \"\n        AAA#G\n        AAA#G\n        BCDEF\n        \"\n\n    patchwork::wrap_plots(A = d1, B = p1, C = p2, D = p3, E = p4, F = p5, G = p6, design = layout)\n}\n\n\n\nAML 2022 scRNAseq\nCML miR-142 KO scRNAseq (LMPP & T cell)\nCML miR-142 KO blast crisis\n\n\n\n\nuse_pinboard(\"onedrive\")\nseurat_object &lt;- get_pin(\"mmu_10x_aml2022_GENCODEm28_HLT.rds\")\n\nPer cell metadata\n\nseurat_object@meta.data |&gt; colnames()\n#&gt;  [1] \"orig.ident\"       \"nCount_RNA\"       \"nFeature_RNA\"     \"ref_genome\"      \n#&gt;  [5] \"tissue\"           \"ckit\"             \"percent_mt\"       \"percent_ribo\"    \n#&gt;  [9] \"percent_hb\"       \"percent_platelet\" \"percent_xist\"     \"chrY_counts\"     \n#&gt; [13] \"percent_myh11\"    \"nCount_SCT\"       \"nFeature_SCT\"     \"SCT_snn_res.0.4\" \n#&gt; [17] \"seurat_clusters\"  \"SCT_snn_res.0.6\"  \"SCT_snn_res.0.8\"  \"SCT_snn_res.1\"   \n#&gt; [21] \"SCT_snn_res.1.2\"  \"SCT_snn_res.0.2\"  \"S.Score\"          \"G2M.Score\"       \n#&gt; [25] \"Phase\"            \"cell_type\"        \"cell_type_fine\"\n\nNumber of samples: 21; total number of cells: 105170\nPer sample QC metrics\n\nsc_qc_plot_per_sample(seurat_object)\n\n\n\n\nPer sample UMAP\n\npal &lt;- scCustomize::DiscretePalette_scCustomize(num_colors = 60, palette = \"varibow\")\nscCustomize::DimPlot_scCustom(seurat_object, reduction = \"umap\", group.by = \"orig.ident\", colors_use = pal) |&gt;\n    dim_plot_mod() + ggplot2::guides(color = ggplot2::guide_legend(ncol = 2))\n\n\n\n\nPer cell QC metrics\n\nsc_qc_plot_group_by(seurat_object, \"tissue\")\n\n\n\nsc_qc_plot_group_by(seurat_object, \"ckit\")\n\n\n\nsc_qc_plot_group_by(seurat_object, \"Phase\")\n\n\n\nsc_qc_plot_group_by(seurat_object, \"cell_type\")\n\n\n\ngc()\n#&gt;              used    (Mb) gc trigger    (Mb)   max used    (Mb)\n#&gt; Ncells    8616137   460.2   15947027   851.7   15947027   851.7\n#&gt; Vcells 3001119203 22896.8 4584584343 34977.7 3056506642 23319.3\n\n\n\n\n\nuse_pinboard(\"onedrive\")\nseurat_object &lt;- get_pin(\"mmu_10x_mir142ko_GENCODEm28_HLT.rds\")\n\nPer cell metadata\n\nseurat_object@meta.data |&gt; colnames()\n#&gt;  [1] \"orig.ident\"       \"nCount_RNA\"       \"nFeature_RNA\"     \"ref_genome\"      \n#&gt;  [5] \"percent_mt\"       \"percent_ribo\"     \"percent_hb\"       \"percent_platelet\"\n#&gt;  [9] \"percent_xist\"     \"chrY_counts\"      \"percent_myh11\"    \"nCount_SCT\"      \n#&gt; [13] \"nFeature_SCT\"     \"SCT_snn_res.0.4\"  \"seurat_clusters\"  \"SCT_snn_res.0.6\" \n#&gt; [17] \"SCT_snn_res.0.8\"  \"SCT_snn_res.1\"    \"SCT_snn_res.1.2\"  \"SCT_snn_res.0.2\" \n#&gt; [21] \"S.Score\"          \"G2M.Score\"        \"Phase\"            \"cell_type\"       \n#&gt; [25] \"cell_type_fine\"\n\nNumber of samples: 18; total number of cells: 166118\nPer sample QC metrics\n\nsc_qc_plot_per_sample(seurat_object)\n\n\n\n\nPer sample UMAP\n\npal &lt;- scCustomize::DiscretePalette_scCustomize(num_colors = 60, palette = \"varibow\")\nscCustomize::DimPlot_scCustom(seurat_object, reduction = \"umap\", group.by = \"orig.ident\", colors_use = pal) |&gt;\n    dim_plot_mod() + ggplot2::guides(color = ggplot2::guide_legend(ncol = 2))\n\n\n\n\nPer cell QC metrics\n\nsc_qc_plot_group_by(seurat_object, \"seurat_clusters\")\n\n\n\nsc_qc_plot_group_by(seurat_object, \"Phase\")\n\n\n\nsc_qc_plot_group_by(seurat_object, \"cell_type\")\n\n\n\n\n\n\n\n\nuse_pinboard(\"onedrive\")\nseurat_object &lt;- get_pin(\"mmu_10x_blastcrisis_GENCODEm28_HLT.rds\")\n\nPer cell metadata\n\nseurat_object@meta.data |&gt; colnames()\n#&gt;  [1] \"orig.ident\"       \"nCount_RNA\"       \"nFeature_RNA\"     \"ref_genome\"      \n#&gt;  [5] \"percent_mt\"       \"percent_ribo\"     \"percent_hb\"       \"percent_platelet\"\n#&gt;  [9] \"percent_xist\"     \"chrY_counts\"      \"percent_myh11\"    \"nCount_SCT\"      \n#&gt; [13] \"nFeature_SCT\"     \"SCT_snn_res.0.4\"  \"seurat_clusters\"  \"SCT_snn_res.0.6\" \n#&gt; [17] \"SCT_snn_res.0.8\"  \"SCT_snn_res.1\"    \"SCT_snn_res.1.2\"  \"SCT_snn_res.0.2\" \n#&gt; [21] \"S.Score\"          \"G2M.Score\"        \"Phase\"            \"cell_type\"       \n#&gt; [25] \"cell_type_fine\"\n\nNumber of samples: 53; total number of cells: 310991\nPer sample QC metrics\n\nsc_qc_plot_per_sample(seurat_object)\n\n\n\n\nPer sample UMAP\n\npal &lt;- scCustomize::DiscretePalette_scCustomize(num_colors = 53, palette = \"varibow\")\nscCustomize::DimPlot_scCustom(seurat_object, reduction = \"umap\", group.by = \"orig.ident\", colors_use = pal, raster = TRUE) |&gt;\n    dim_plot_mod() + ggplot2::guides(color = ggplot2::guide_legend(ncol = 2))\n\n\n\n\nPer cell QC metrics\n\nsc_qc_plot_group_by(seurat_object, \"seurat_clusters\")\n\n\n\nsc_qc_plot_group_by(seurat_object, \"Phase\")\n\n\n\nsc_qc_plot_group_by(seurat_object, \"cell_type\")\n\n\n\n\n\n\n\n\nUsing Python?\nhttps://mojaveazure.github.io/seurat-disk/articles/convert-anndata.html"
  }
]