---
title: "AML datasets"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{AML datasets}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
    collapse = TRUE,
    comment = "#>",
    warning = FALSE,
    message = FALSE
)
```


# Mouse
```{r setup}
library(haemdata)

se <- get_data("mmu_mrna_all_GENCODEm28_HLT_qc.rds")

se <- subset(se,
    select = grepl("AML", SummarizedExperiment::colData(se)$project)
)

pca <- pca_se(se)
```

```{r pca_plots}
pca$biplot
pca$pairs_plot
```
```{r pca_corr, fig.height=9, fig.width=8}
pca$correlation_plot
```

```{r transgenes}
plot_transgenes_se(se)
```

# Human

```{r hsa_flt3}
se <- get_data("hsa_mrna_flt3_GENCODEr40_qc.rds")

pca <- pca_se(se, col_by = "patient_id")
```

```{r hsa_pca_plots}
pca$biplot
pca$pairs_plot
```
```{r hsa_pca_corr, fig.height=9, fig.width=8}
pca$correlation_plot
```
