---
title: "Missing metadata"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Missing metadata}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
    collapse = TRUE,
    comment = "#>",
    warning = FALSE,
    message = FALSE
)
```

```{r  message=FALSE, warning=FALSE}
require(haemdata)
use_pinboard("devel")

metadata_mmu <- get_pin("metadata_mmu.csv")
```

```{r echo=FALSE, include=FALSE}
sample_summary <- metadata_mmu |>
    dplyr::ungroup() |>
    dplyr::select(strandedness, tissue, treatment) |>
    gtsummary::tbl_summary(missing_text = "(Missing)")

mouse_summary <- metadata_mmu |>
    dplyr::ungroup() |>
    dplyr::select(mouse_id, genotype, sex) |>
    gtsummary::tbl_summary(missing_text = "(Missing)")

n_mice <- dplyr::n_distinct(metadata_mmu$mouse_id, na.rm = TRUE)

sex_by_treatment <- metadata_mmu |>
    gtsummary::tbl_cross(
        row = sex,
        col = treatment,
        percent = "none"
    )

sex_by_genotype <- metadata_mmu |>
    gtsummary::tbl_cross(
        row = sex,
        col = genotype,
        percent = "none"
    )
```

# Mice 
`Haemdata` includes `r nrow(metadata_mmu)` RNAseq libraries from `r dplyr::n_distinct(metadata_mmu$mouse_id, na.rm = TRUE)` mice. Metadata
are parsed by functions in [`import_metadata.R`](https://github.com/drejom/haemdata/blob/main/scripts/import_metadata.R) and collated by the `make_metadata_mmu()` function, sourced in the same document.

## Missingness
```{r echo=FALSE, img.width=8, message=FALSE}
naniar::gg_miss_fct(metadata_mmu, project)
```

Metadata have been parsed from many sources in various formats and undoubtedly require close inspection and correction. Please [report any
issues](https://github.com/drejom/haemdata/issues).

### Sex by treatment 
`r sex_by_treatment`

### Sex by genotype
`r sex_by_genotype`

### Sample summary
`r sample_summary`

### Mouse summary
`r mouse_summary`

# Humans

`Haemdata` includes code to produce `SummarisedExperiments` from human patients with MDS ([EGAD00001003891](https://ega-archive.org/datasets/EGAD00001003891)) 
and FLT3 AML patients from the COH Biobank. More on metadata to come...
