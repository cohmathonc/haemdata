{
  "hash": "b0817f25620f9ef0e537405b77217fbf",
  "result": {
    "markdown": "---\ntitle: \"AML datasets\"\n---\n\n\n\n\n::: {.panel-tabset}\n\n## Mouse datasets \nNote: Validation mice also available via Haemdata/Ondrive. See [X]() for more details.\n\nFirst, we need to setup the pin-board and download the mouse datasets. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(haemdata)\nuse_pinboard(\"devel\")\n\nall_mice <- get_pin(\"mmu_mrna_all_mice_GENCODEm28_HLT_qc.rds\")\n```\n:::\n\n\n::: {.panel-tabset}\n\n### 2016 mice\n\n::: {.cell}\n\n```{.r .cell-code}\nse <- subset(all_mice,\n    select = grepl(\"2016\", SummarizedExperiment::colData(all_mice)$batch)\n)\n\npca <- pca_se(se)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npca$biplot\n```\n\n::: {.cell-output-display}\n![](aml_datasets_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n\n```{.r .cell-code}\npca$pairs_plot\n```\n\n::: {.cell-output-display}\n![](aml_datasets_files/figure-html/unnamed-chunk-3-2.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npca$correlation_plot\n```\n\n::: {.cell-output-display}\n![](aml_datasets_files/figure-html/unnamed-chunk-4-1.png){width=768}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot_transgenes_se(se)\n```\n\n::: {.cell-output-display}\n![](aml_datasets_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmetadata_mmu |>\nplot_cohort_survival(\"AML.mRNA.2016\")\n```\n\n::: {.cell-output-display}\n![](aml_datasets_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n### 2018 mice\n\n::: {.cell}\n\n```{.r .cell-code}\nse <- subset(all_mice,\n    select = grepl(\"AML.mRNA.2018.all_samples\", SummarizedExperiment::colData(all_mice)$cohort)\n)\n\npca <- pca_se(se)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npca$biplot\n```\n\n::: {.cell-output-display}\n![](aml_datasets_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n\n```{.r .cell-code}\npca$pairs_plot\n```\n\n::: {.cell-output-display}\n![](aml_datasets_files/figure-html/unnamed-chunk-8-2.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npca$correlation_plot\n```\n\n::: {.cell-output-display}\n![](aml_datasets_files/figure-html/unnamed-chunk-9-1.png){width=768}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot_transgenes_se(se)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmetadata_mmu |>\nplot_cohort_survival(\"AML.mRNA.2018\")\n```\n\n::: {.cell-output-display}\n![](aml_datasets_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n### Radiation mice\n\n::: {.cell}\n\n```{.r .cell-code}\nse <- subset(all_mice,\n    select = grepl(\"AML.mRNA.2020\", SummarizedExperiment::colData(all_mice)$cohort)\n)\nse <- subset(se,\n    select = grepl(\"PBMC\", SummarizedExperiment::colData(se)$tissue)\n)\n\npca <- pca_se(se)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npca$biplot\n```\n\n::: {.cell-output-display}\n![](aml_datasets_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n\n```{.r .cell-code}\npca$pairs_plot\n```\n\n::: {.cell-output-display}\n![](aml_datasets_files/figure-html/unnamed-chunk-13-2.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npca$correlation_plot\n```\n\n::: {.cell-output-display}\n![](aml_datasets_files/figure-html/unnamed-chunk-14-1.png){width=768}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot_transgenes_se(se)\n```\n\n::: {.cell-output-display}\n![](aml_datasets_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmetadata_mmu |>\nplot_cohort_survival(\"AML.mRNA.2020\")\n```\n\n::: {.cell-output-display}\n![](aml_datasets_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n\n### Chemo mice\n\n::: {.cell}\n\n```{.r .cell-code}\nse <- subset(all_mice,\n    select = grepl(\"RxGroup\", SummarizedExperiment::colData(all_mice)$cohort)\n)\n\npca <- pca_se(se)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npca$biplot\n```\n\n::: {.cell-output-display}\n![](aml_datasets_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n\n```{.r .cell-code}\npca$pairs_plot\n```\n\n::: {.cell-output-display}\n![](aml_datasets_files/figure-html/unnamed-chunk-18-2.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npca$correlation_plot\n```\n\n::: {.cell-output-display}\n![](aml_datasets_files/figure-html/unnamed-chunk-19-1.png){width=768}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot_transgenes_se(se)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmetadata_mmu |>\nplot_cohort_survival(\"RxGroup\")\n```\n\n::: {.cell-output-display}\n![](aml_datasets_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n:::\n\n\n### scRNAseq mice 2022\n\n::: {.cell}\n\n```{.r .cell-code}\nse <- subset(all_mice,\n    select = grepl(\"AML.scRNAseq.2022\", SummarizedExperiment::colData(all_mice)$cohort)\n)\n\npca <- pca_se(se)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npca$biplot\n```\n\n::: {.cell-output-display}\n![](aml_datasets_files/figure-html/unnamed-chunk-23-1.png){width=672}\n:::\n\n```{.r .cell-code}\npca$pairs_plot\n```\n\n::: {.cell-output-display}\n![](aml_datasets_files/figure-html/unnamed-chunk-23-2.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npca$correlation_plot\n```\n\n::: {.cell-output-display}\n![](aml_datasets_files/figure-html/unnamed-chunk-24-1.png){width=768}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot_transgenes_se(se)\n```\n:::\n\n\n### Bone marrow\n\n::: {.cell}\n\n```{.r .cell-code}\nse <- subset(all_mice,\n    select = (\"BM\" == SummarizedExperiment::colData(all_mice)$tissue)\n)\nse <- subset(se,\n    select = grepl(\"AML\", SummarizedExperiment::colData(se)$cohort)\n)\n\npca <- pca_se(se)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npca$biplot\n```\n\n::: {.cell-output-display}\n![](aml_datasets_files/figure-html/unnamed-chunk-27-1.png){width=672}\n:::\n\n```{.r .cell-code}\npca$pairs_plot\n```\n\n::: {.cell-output-display}\n![](aml_datasets_files/figure-html/unnamed-chunk-27-2.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npca$correlation_plot\n```\n\n::: {.cell-output-display}\n![](aml_datasets_files/figure-html/unnamed-chunk-28-1.png){width=768}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot_transgenes_se(se)\n```\n:::\n\n \n:::\n\n## Human datasets\n\nFirst, we need to setup the pin-board from which well retrieve the human datasets\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(haemdata)\nuse_pinboard(\"devel\")\n```\n:::\n\n\n::: {.panel-tabset}\n\n### COH patients \n\nCity of Hope Biobank FLT3 patients\n\n**Include some background info on these samples, IRB etc**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(haemdata)\nuse_pinboard(\"devel\")\nse <- get_pin(\"hsa_mrna_flt3_GENCODEr40_qc.rds\")\n\n# ## Add week_scaled column, where time is scaled for each patient\n# SummarizedExperiment::colData(se) <- SummarizedExperiment::colData(se) |>\n#     janitor::remove_constant() |>\n#     dplyr::as_tibble() |>\n#     dplyr::group_by(patient_id) |>\n#     dplyr::mutate(weeks_scaled = as.vector(scale(weeks))) |>\n#     dplyr::ungroup() |>\n#     `rownames<-`(colnames(se)) |>\n#     S4Vectors::DataFrame()\n\n#pca <- pca_se(se, col_by = \"weeks_scaled\")\npca <- pca_se(se, col_by = \"patient_id\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npca$biplot\n```\n\n::: {.cell-output-display}\n![](aml_datasets_files/figure-html/unnamed-chunk-32-1.png){width=672}\n:::\n\n```{.r .cell-code}\npca$pairs_plot\n```\n\n::: {.cell-output-display}\n![](aml_datasets_files/figure-html/unnamed-chunk-32-2.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npca$correlation_plot\n```\n\n::: {.cell-output-display}\n![](aml_datasets_files/figure-html/unnamed-chunk-33-1.png){width=768}\n:::\n:::\n\n\n### Relapse patients\nKim et al 2020 *Sci Rep* [![DOI](https://zenodo.org/badge/DOI/10.1038/s41598-020-76933-2.svg)](https://doi.org/10.1038/s41598-020-76933-2)\n\nBioproject: [PRJEB27973](https://www.ncbi.nlm.nih.gov/bioproject/?term=PRJEB27973)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nse <- get_pin(\"hsa_mrna_kim_GENCODEr40_qc.rds\")\n\npca <- pca_se(se, col_by = \"timepoint\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npca$biplot\n```\n\n::: {.cell-output-display}\n![](aml_datasets_files/figure-html/unnamed-chunk-35-1.png){width=672}\n:::\n\n```{.r .cell-code}\npca$pairs_plot\n```\n\n::: {.cell-output-display}\n![](aml_datasets_files/figure-html/unnamed-chunk-35-2.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npca$correlation_plot\n```\n\n::: {.cell-output-display}\n![](aml_datasets_files/figure-html/unnamed-chunk-36-1.png){width=768}\n:::\n:::\n\n\n:::\n\n:::",
    "supporting": [
      "aml_datasets_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}