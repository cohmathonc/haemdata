---
title: "AML datasets"
---

```{r, include = FALSE}
knitr::opts_chunk$set(
    collapse = TRUE,
    comment = "#>",
    warning = FALSE,
    message = FALSE
)
```

::: {.panel-tabset}

## Mouse datasets 
Note: Validation mice also available via Haemdata/Ondrive. See [X]() for more details.

First, we need to setup the pin-board and download the mouse datasets. 

```{r setup}
library(haemdata)
use_pinboard("onedrive")

all_mice <- get_pin("mmu_mrna_all_mice_GENCODEm28_HLT_qc.rds")
metadata_mmu <- get_pin("metadata_mmu.csv")
```

::: {.panel-tabset}

### 2016 mice
```{r}
se <- subset(all_mice,
    select = grepl("2016", SummarizedExperiment::colData(all_mice)$batch)
)

pca <- pca_se(se)
```

```{r}
pca$biplot
pca$pairs_plot
```

```{r fig.height=9, fig.width=8}
pca$correlation_plot
```

```{r}
plot_transgenes_se(se)
```

```{r }
metadata_mmu |>
plot_cohort_survival("AML.mRNA.2016")
```

### 2018 mice
```{r}
se <- subset(all_mice,
    select = grepl("AML.mRNA.2018.all_samples", SummarizedExperiment::colData(all_mice)$cohort)
)

pca <- pca_se(se)
```

```{r }
pca$biplot
pca$pairs_plot
```
```{r fig.height=9, fig.width=8}
pca$correlation_plot
```

```{r, eval = FALSE }
plot_transgenes_se(se)
```

```{r }
metadata_mmu |>
plot_cohort_survival("AML.mRNA.2018")
```

### Radiation mice
```{r}
se <- subset(all_mice,
    select = grepl("AML.mRNA.2020", SummarizedExperiment::colData(all_mice)$cohort)
)
se <- subset(se,
    select = grepl("PBMC", SummarizedExperiment::colData(se)$tissue)
)

pca <- pca_se(se)
```

```{r }
pca$biplot
pca$pairs_plot
```

```{r fig.height=9, fig.width=8}
pca$correlation_plot
```

```{r }
plot_transgenes_se(se)
```

```{r }
metadata_mmu |>
plot_cohort_survival("AML.mRNA.2020")
```

### Chemo mice
```{r}
se <- subset(all_mice,
    select = grepl("RxGroup", SummarizedExperiment::colData(all_mice)$cohort)
)

pca <- pca_se(se)
```

```{r }
pca$biplot
pca$pairs_plot
```

```{r fig.height=9, fig.width=8}
pca$correlation_plot
```

```{r eval = FALSE }
plot_transgenes_se(se)
```

```{r }
metadata_mmu |>
plot_cohort_survival("RxGroup")
```

### scRNAseq mice 2022
```{r}
se <- subset(all_mice,
    select = grepl("AML.scRNAseq.2022", SummarizedExperiment::colData(all_mice)$cohort)
)

pca <- pca_se(se)
```

```{r }
pca$biplot
pca$pairs_plot
```

```{r fig.height=9, fig.width=8}
pca$correlation_plot
```

```{r eval = FALSE }
plot_transgenes_se(se)
```

### Bone marrow
```{r}
se <- subset(all_mice,
    select = ("BM" == SummarizedExperiment::colData(all_mice)$tissue)
)
se <- subset(se,
    select = grepl("AML", SummarizedExperiment::colData(se)$cohort)
)

pca <- pca_se(se)
```

```{r }
pca$biplot
pca$pairs_plot
```

```{r fig.height=9, fig.width=8}
pca$correlation_plot
```

```{r eval = FALSE }
plot_transgenes_se(se)
```
 
:::

## Human datasets

First, we need to setup the pin-board from which well retrieve the human datasets

```{r, eval=FALSE}
library(haemdata)
use_pinboard("onedrive")
```

::: {.panel-tabset}

### COH patients 

City of Hope Biobank FLT3 patients

**Include some background info on these samples, IRB etc**

```{r }
library(haemdata)
use_pinboard("onedrive")
se <- get_pin("hsa_mrna_flt3_GENCODEr40_qc.rds")

pca <- pca_se(se, col_by = "patient_id")
```

```{r }
pca$biplot
pca$pairs_plot
```
```{r  fig.height=9, fig.width=8}
pca$correlation_plot
```

### Relapse patients
Kim et al 2020 *Sci Rep* [![DOI](https://zenodo.org/badge/DOI/10.1038/s41598-020-76933-2.svg)](https://doi.org/10.1038/s41598-020-76933-2)

Bioproject: [PRJEB27973](https://www.ncbi.nlm.nih.gov/bioproject/?term=PRJEB27973)

```{r }
se <- get_pin("hsa_mrna_kim_GENCODEr40_qc.rds")

pca <- pca_se(se, col_by = "timepoint")
```

```{r }
pca$biplot
pca$pairs_plot
```
```{r  fig.height=9, fig.width=8}
pca$correlation_plot
```

:::

:::